# ETFCharts: ì°¨íŠ¸ ì˜ì—­

> ğŸ“„ **ìƒìœ„ ë¬¸ì„œ**: [ETF_DETAIL.md](./ETF_DETAIL.md) Â§ 3-6

ê°€ê²©, ë§¤ë§¤ ë™í–¥, RSI, MACD, ì§€ì§€ì„ /ì €í•­ì„ ì„ **ìˆ˜ì§ ë°°ì¹˜**í•˜ëŠ” í†µí•© ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ. í‘œì‹œ ì¡°ê±´Â·ìŠ¤í¬ë¡¤ ë™ê¸°í™”Â·ê¸°ìˆ ì§€í‘œ ë°ì´í„° ì—°ë™ì„ ë‹´ë‹¹í•œë‹¤.

---

## 1. ë™ì‘ ë°©ì‹ ê°œìš”

- **ì°¨íŠ¸ 4ì¢…**: PriceChart, TradingFlowChart, RSIChart, MACDChart
- **ë¶€ê°€**: TechnicalIndicatorsSection (RSI+MACD), SupportResistanceSection (ì§€ì§€/ì €í•­)
- **í‘œì‹œ ì¡°ê±´**: settings ë° í† ê¸€ë¡œ ì œì–´
- **ìŠ¤í¬ë¡¤ ë™ê¸°í™”**: ê°€ê²© ì°¨íŠ¸ â†” ë§¤ë§¤ë™í–¥ ì°¨íŠ¸ ê°€ë¡œ ìŠ¤í¬ë¡¤

---

## 2. ì°¨íŠ¸ë³„ í‘œì‹œ ì¡°ê±´

| ì°¨íŠ¸ | ì»´í¬ë„ŒíŠ¸ | ì¡°ê±´ |
|------|----------|------|
| ê°€ê²© | PriceChart | `showVolume` (settings.display.showVolume, ê¸°ë³¸ true) |
| ë§¤ë§¤ ë™í–¥ | TradingFlowChart | `showTradingFlow` (settings.display.showTradingFlow, ê¸°ë³¸ true) |
| RSI | RSIChart | `showRSI` (useState, ê¸°ë³¸ true) |
| MACD | MACDChart | `showMACD` (useState, ê¸°ë³¸ true) |
| ê¸°ìˆ ì§€í‘œ ì„¹ì…˜ | TechnicalIndicatorsSection | `showTechnicalSection` (ê¸°ë³¸ true, í•­ìƒ í‘œì‹œ) |
| ì§€ì§€/ì €í•­ | SupportResistanceSection | supportResistanceData ìˆìœ¼ë©´ í‘œì‹œ |

---

## 3. ê°€ê²© ì°¨íŠ¸ ë¶€ê°€ ê¸°ëŠ¥

- **ë§¤ì…ê°€ ìˆ˜í‰ì„ **: `purchasePrice` ì „ë‹¬ ì‹œ ReferenceLine í‘œì‹œ
- **ì§€ì§€ì„ /ì €í•­ì„ **: `calculateSupportResistance(pricesData)` â€” í”¼ë´‡, ì´ë™í‰ê· , 20ì¼ ê³ /ì € ê¸°ë°˜

---

## 4. ìŠ¤í¬ë¡¤ ë™ê¸°í™”

- **êµ¬í˜„**: `priceChartScrollRef`, `tradingFlowChartScrollRef`ë¡œ ë‘ ì°¨íŠ¸ì˜ scrollLeft ë™ê¸°í™”
- **í•¸ë“¤ëŸ¬**: `onPriceChartScroll`, `onTradingFlowChartScroll` â€” í•œ ìª½ ìŠ¤í¬ë¡¤ ì‹œ ë‹¤ë¥¸ ìª½ì— ë°˜ì˜
- **ë¬´í•œ ë£¨í”„ ë°©ì§€**: `isScrollingSyncRef` í”Œë˜ê·¸ + `requestAnimationFrame`ìœ¼ë¡œ ë‹¤ìŒ í”„ë ˆì„ì—ì„œ í”Œë˜ê·¸ í•´ì œ

```javascript
const handlePriceChartScroll = () => {
  if (isScrollingSyncRef.current) return
  isScrollingSyncRef.current = true
  tradingFlowChartScrollRef.current.scrollLeft = priceChartScrollRef.current.scrollLeft
  requestAnimationFrame(() => { isScrollingSyncRef.current = false })
}
```

---

## 5. ê¸°ìˆ ì§€í‘œ ë°ì´í„°

### 5-1. RSI/MACD ê³„ì‚°ìš© í™•ì¥ ë°ì´í„°

- **í•„ìš”**: RSI 14ì¼ â†’ 15ê±´ ì´ìƒ, MACD 12/26/9 â†’ 35ê±´ ì´ìƒ. **ì„ í–‰ 60ì¼** ì¶”ê°€ ìš”ì²­
- **API**: `GET /api/etfs/{ticker}/prices` (startDate = dateRange.startDate - 60ì¼)
- **enabled**: `showRSI || showMACD`ì¼ ë•Œë§Œ useQuery ì‹¤í–‰
- **ì •ë ¬**: APIëŠ” ìµœì‹ ìˆœ â†’ ì˜¤ë¦„ì°¨ìˆœ ë³€í™˜ í›„ calculateRSI, calculateMACD

### 5-2. ì§€ì§€/ì €í•­

- **ê³„ì‚°**: `calculateSupportResistance(pricesData)` â€” pricesData ê·¸ëŒ€ë¡œ(ìµœì‹ ìˆœ)
- **ë°˜í™˜**: currentPrice, pivot, movingAverages, recentLevels, supports, resistances

---

## 6. TechnicalIndicatorsSection ìƒì„¸

- **RSI**: 14ì¼, í•´ì„ í…ìŠ¤íŠ¸ (ê³¼ë§¤ìˆ˜/ê³¼ë§¤ë„/ìƒìŠ¹/í•˜ë½)
- **MACD**: 12/26/9, ê³¨ë“ /ë°ë“œí¬ë¡œìŠ¤Â·ëª¨ë©˜í…€ í•´ì„
- **í† ê¸€**: RSI, MACD ê°ê° ì²´í¬ë°•ìŠ¤ë¡œ í‘œì‹œ/ìˆ¨ê¹€
- **ë‘˜ ë‹¤ êº¼ì§**: "RSI ë˜ëŠ” MACDë¥¼ ì„ íƒí•˜ë©´ ê¸°ìˆ ì§€í‘œ ì°¨íŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤" ì•ˆë‚´

---

## 7. SupportResistanceSection ìƒì„¸

- **ì €í•­ì„ **: ìƒë‹¨, ë¹¨ê°„ ë§‰ëŒ€Â·ê°€ê²©Â·ê±°ë¦¬%
- **í˜„ì¬ê°€**: ê°€ìš´ë° ê°•ì¡° ë°”
- **ì§€ì§€ì„ **: í•˜ë‹¨, íŒŒë€ ë§‰ëŒ€Â·ê°€ê²©Â·ê±°ë¦¬%
- **ìµœê·¼ ê³ /ì €**: 20ì¼ ìµœê³ ê°€Â·ìµœì €ê°€ ì¹´ë“œ
- **ìƒì„¸ í† ê¸€**: "ì „ì²´ ë ˆë²¨ ë³´ê¸°" í¼ì¹˜ë©´ ì €í•­/ì§€ì§€ ì „ì²´ ëª©ë¡ + ì½ëŠ” ë²•

---

## 8. ë¡œë”©/ì—ëŸ¬

ê° ì°¨íŠ¸ ì˜ì—­ë³„ë¡œ LoadingIndicator ë˜ëŠ” ErrorFallback, refetch ë²„íŠ¼ ì œê³µ.

---

## 9. ë¬¸ì œ í•´ê²°

| í˜„ìƒ | ì›ì¸ | ì¡°ì¹˜ |
|------|------|------|
| RSI/MACD ì•ˆ ë‚˜ì˜´ | í™•ì¥ ë°ì´í„° ë¯¸ìš”ì²­ | showRSI/showMACD true í™•ì¸, extendedDateRange ê³„ì‚° |
| ìŠ¤í¬ë¡¤ ë™ê¸°í™” ì•ˆ ë¨ | ref ë¯¸ì „ë‹¬ ë˜ëŠ” scroll ì´ë²¤íŠ¸ ë¯¸ì—°ê²° | PriceChart/TradingFlowChartì— scrollRef, onScroll í™•ì¸ |
| ì§€ì§€/ì €í•­ ë¹ˆ í™”ë©´ | supportResistanceData null | calculateSupportResistance í˜¸ì¶œ ë° pricesData ì „ë‹¬ í™•ì¸ |
| ë¬´í•œ ìŠ¤í¬ë¡¤ ë£¨í”„ | isScrollingSyncRef ë¯¸ì‚¬ìš© | requestAnimationFrame ë‚´ í”Œë˜ê·¸ í•´ì œ í™•ì¸ |

---

## 10. ìš”ì•½

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì»´í¬ë„ŒíŠ¸ | `components/etf/ETFCharts.jsx` |
| í•˜ìœ„ | PriceChart, TradingFlowChart, RSIChart, MACDChart, TechnicalIndicatorsSection, SupportResistanceSection |
| í™•ì¥ API | prices (startDate - 60ì¼) |
| ìœ í‹¸ | calculateRSI, calculateMACD, calculateSupportResistance |
| ìŠ¤í¬ë¡¤ | ref ê¸°ë°˜ ë™ê¸°í™”, requestAnimationFrame |

---

## 11. ê´€ë ¨ íŒŒì¼

| íŒŒì¼ | ì—­í•  |
|------|------|
| `frontend/src/components/etf/ETFCharts.jsx` | ì°¨íŠ¸ í†µí•©, TechnicalIndicatorsSection, SupportResistanceSection |
| `frontend/src/components/charts/PriceChart.jsx` | ìº”ë“¤+ê±°ë˜ëŸ‰ |
| `frontend/src/components/charts/TradingFlowChart.jsx` | ë§¤ë§¤ë™í–¥ |
| `frontend/src/components/charts/RSIChart.jsx` | RSI |
| `frontend/src/components/charts/MACDChart.jsx` | MACD |
| `frontend/src/utils/technicalIndicators.js` | RSI, MACD, ì§€ì§€/ì €í•­ ê³„ì‚° |
