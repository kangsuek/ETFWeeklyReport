# DateRangeSelector: ë‚ ì§œ ë²”ìœ„ ì„ íƒ

> ğŸ“„ **ìƒìœ„ ë¬¸ì„œ**: [ETF_DETAIL.md](./ETF_DETAIL.md) Â§ 3-5

ê°€ê²©Â·ë§¤ë§¤ë™í–¥ ì°¨íŠ¸ì˜ **ë¶„ì„ ê¸°ê°„**ì„ ì„ íƒí•˜ëŠ” ì»´í¬ë„ŒíŠ¸. 7ì¼/1ê°œì›”/3ê°œì›”/6ê°œì›”/YTD/1ë…„ í”„ë¦¬ì…‹ê³¼ ì»¤ìŠ¤í…€ ë‚ ì§œ ì…ë ¥ì„ ì œê³µí•˜ë©°, ì„¤ì • í˜ì´ì§€ì˜ ê¸°ë³¸ê°’ê³¼ ì—°ë™í•œë‹¤.

---

## 1. ë™ì‘ ë°©ì‹ ê°œìš”

- **í”„ë¦¬ì…‹**: 7d, 1m, 3m, 6m, ytd, 1y, custom
- **ì—°ë™**: `defaultRange` propìœ¼ë¡œ ì„¤ì •ê°’(7Dâ†’7d, 1Mâ†’1m, 3Mâ†’3m) ì „ë‹¬
- **ì½œë°±**: `onDateRangeChange({ startDate, endDate, range })` í˜¸ì¶œ
- **ê²€ì¦**: ì»¤ìŠ¤í…€ ë‚ ì§œëŠ” `validateDateRange`ë¡œ ê²€ì¦, `MAX_DATE_RANGE_DAYS` ì œí•œ

### ETFDetail ì—°ë™

- `userModifiedRef`: ì‚¬ìš©ìê°€ ìˆ˜ë™ ë³€ê²½ ì‹œ true â†’ ì„¤ì • ê¸°ë³¸ê°’ìœ¼ë¡œ ë®ì–´ì“°ì§€ ì•ŠìŒ
- `key`: `defaultRangeFromSettings` ë³€ê²½ ì‹œ ì»´í¬ë„ŒíŠ¸ ë¦¬ë§ˆìš´íŠ¸í•˜ì—¬ ìƒˆ ê¸°ë³¸ê°’ ë°˜ì˜
- queryKey: `dateRange.startDate`, `dateRange.endDate` í¬í•¨ â†’ ë²”ìœ„ ë³€ê²½ ì‹œ ê°€ê²©Â·ë§¤ë§¤ë™í–¥ ìë™ ì¬ìš”ì²­

---

## 2. í”„ë¦¬ì…‹ë³„ ê³„ì‚°

| range | ê³„ì‚° | date-fns |
|-------|------|----------|
| 7d | ì˜¤ëŠ˜ - 7ì¼ | subDays(today, 7) |
| 1m | ì˜¤ëŠ˜ - 1ê°œì›” | subMonths(today, 1) |
| 3m | ì˜¤ëŠ˜ - 3ê°œì›” | subMonths(today, 3) |
| 6m | ì˜¤ëŠ˜ - 6ê°œì›” | subMonths(today, 6) |
| ytd | ì˜¬í•´ 1ì›” 1ì¼ | startOfYear(today) |
| 1y | ì˜¤ëŠ˜ - 1ë…„ | subYears(today, 1) |
| custom | ì‚¬ìš©ì ì…ë ¥ | â€” |

ì¢…ë£Œì¼ì€ í•­ìƒ `format(today, 'yyyy-MM-dd')`.

---

## 3. ì»¤ìŠ¤í…€ ë‚ ì§œ

- **ì…ë ¥**: startDate, endDate (type="date")
- **ì ìš© ë²„íŠ¼**: í´ë¦­ ì‹œ `applyCustomRange()` í˜¸ì¶œ
- **ê²€ì¦**: `validateDateRange(startDate, endDate)` â€” isValid, error ë°˜í™˜
- **ì—ëŸ¬ í‘œì‹œ**: `bg-red-50 border-red-200` ë°•ìŠ¤ì— error ë©”ì‹œì§€
- **ì„ íƒëœ ê¸°ê°„ í‘œì‹œ**: customì´ ì•„ë‹ ë•Œ "ì„ íƒëœ ê¸°ê°„: {startDate} ~ {endDate}"

---

## 4. ì´ˆê¸°í™” ë° defaultRange ë°˜ì˜

```javascript
useEffect(() => {
  if (initialStartDate && initialEndDate) return // ë¶€ëª¨ê°€ ì´ë¯¸ ì„¤ì •í•œ ê²½ìš° ìŠ¤í‚µ
  if (defaultRange !== 'custom') {
    handlePresetClick(defaultRange)
  }
}, [defaultRange, initialStartDate, initialEndDate])
```

- ì„¤ì • í˜ì´ì§€ì—ì„œ defaultDateRange ë³€ê²½ ì‹œ ETFDetailì´ `key`ë¥¼ ë°”ê¿” ë¦¬ë§ˆìš´íŠ¸ â†’ ìƒˆ defaultRange ì ìš©
- `userModifiedRef`ê°€ trueë©´ ETFDetailì˜ useEffectì—ì„œ defaultRange ì—…ë°ì´íŠ¸ë¥¼ ë¬´ì‹œ

---

## 5. ë¬¸ì œ í•´ê²°

| í˜„ìƒ | ì›ì¸ | ì¡°ì¹˜ |
|------|------|------|
| ì„¤ì • ë³€ê²½í•´ë„ ë²”ìœ„ ì•ˆ ë°”ë€œ | userModifiedRefê°€ ì´ë¯¸ true | ì´ˆê¸°í™” ë²„íŠ¼ ì¶”ê°€ ë˜ëŠ” í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ |
| ì»¤ìŠ¤í…€ ì ìš© ì‹œ ì—ëŸ¬ | ë‚ ì§œ ì—­ì „, ë²”ìœ„ ì´ˆê³¼ | validateDateRange, MAX_DATE_RANGE_DAYS í™•ì¸ |
| ê¸°ê°„ í‘œì‹œê°€ ì˜ëª»ë¨ | date-fns ë¡œì¼€ì¼/íƒ€ì„ì¡´ | format(today, 'yyyy-MM-dd') ì¼ê´€ ì ìš© |

---

## 6. ìš”ì•½

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì»´í¬ë„ŒíŠ¸ | `components/charts/DateRangeSelector.jsx` |
| í”„ë¦¬ì…‹ | 7d, 1m, 3m, 6m, ytd, 1y, custom |
| ê²€ì¦ | `utils/validation.js` validateDateRange |
| ìœ í‹¸ | `utils/dateRange.js` calculateDateRange (ETFDetail ì´ˆê¸°ê°’ìš©) |
| constants | MAX_DATE_RANGE_DAYS |

---

## 7. ê´€ë ¨ íŒŒì¼

| íŒŒì¼ | ì—­í•  |
|------|------|
| `frontend/src/components/charts/DateRangeSelector.jsx` | ë‚ ì§œ ë²”ìœ„ ì„ íƒ UI |
| `frontend/src/utils/dateRange.js` | calculateDateRange (ì´ˆê¸°ê°’ ê³„ì‚°) |
| `frontend/src/utils/validation.js` | validateDateRange |
| `frontend/src/constants.js` | MAX_DATE_RANGE_DAYS |
| `frontend/src/pages/ETFDetail.jsx` | defaultRange, onDateRangeChange, userModifiedRef |
